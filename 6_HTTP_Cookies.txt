HTTP Cookies

********************************************************************************************************************

HTTP is Stateless
Every request is treated independently
Server does not retain state for clients
Every request needs to be separately authenticated
Every request MUST carry auth information

********************************************************************************************************************

Cookies
https://msdn.microsoft.com/en-us/library/windows/desktop/aa384321(v=vs.85).aspx
Allows server to store and retrieve data from the client
Typically stored in a file on the client side
Text only; No executable code
Cannot exceed 4K in size
Allows for retaining state with the Client’s help
- Session Management
- User Preferences

********************************************************************************************************************

Wireshark Filter
http.set_cookie
http.cookie

********************************************************************************************************************

Cookie Attributes

1.) expires
Session Cookie if “expires” not mentioned
Format: DAY, DD-MMM-YYYY HH:MM:SS GMT –  Mon, 22-Nov-2013 22:45:00 GMT
Max-Age parameter in newer RFC 6265
Interval in seconds after receiving the cookie

2.) domain
Domain for which it is valid
Example
docs.google.com
.images.google.com

3.) path
Path for which it is valid
E.g.
Sid1=asd; Path=/;
Sid2=xyz; Path=/blog;

4.) secure
Only sent over HTTPS

5.) httponly
Cannot be accessed by Client side scripts directly
Cannot be scripted using Javascript
XSS mitigation mechanism

********************************************************************************************************************

HTTP Cookies demo

In Kali

$ pip install webob
$ pip install paste
$ pip install webapp2
$ ./HttpCookie.py
serving on 0.0.0.0:8080 view at http://127.0.0.1:8080

In Browser
http://127.0.0.1:8080/

HTTP Headers Received:
Content-Length : 0
User-Agent : Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0
Connection : keep-alive
Host : 127.0.0.1:8080
Accept : text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language : en-US,en;q=0.5
Content-Type :
Accept-Encoding : gzip, deflate

http://127.0.0.1:8080/

HTTP Headers Received:
Cookie : root_session_id=136721423411461844639149243247998156045
Content-Length : 0
User-Agent : Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0
Connection : keep-alive
Host : 127.0.0.1:8080
Accept : text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language : en-US,en;q=0.5
Content-Type :
Accept-Encoding : gzip, deflate

http://127.0.0.1:8080/blog

HTTP Headers Received:
Cookie : blog_session_id=267708841143856349915497347572831182576; root_session_id=250898507645453984430626664796310784301
Content-Length : 0
User-Agent : Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0
Connection : keep-alive
Host : 127.0.0.1:8080
Accept : text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language : en-US,en;q=0.5
Content-Type :
Accept-Encoding : gzip, deflate

********************************************************************************************************************
